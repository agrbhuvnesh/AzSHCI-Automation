# This script deletes all the arc extensions for a single Azure Stack HCI cluster.

# Code starts here

# Define subscriptionId, resourceGroup, tenantId and clusterId
$subscriptionId = ""
$resourceGroup = ""
$tenantId = ""
$clusterId = ""

# Login to Azure by passing in the tenant ID
$login = az login --tenant $tenantId

# Set the active subscription to the one specified in $subscriptionId
az account set -s $subscriptionId

# Use Azure CLI to delete all Arc extensions for the current cluster
az resource delete --ids (az stack-hci extension list --arc-setting-name "default" --cluster-name $clusterId --resource-group $resourceGroup --subscription $subscriptionId --query "[].id" -o tsv)
    